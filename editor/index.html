<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pico AutoInput Editor v6</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>

<body class="show-errors">

    <div id="help-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0; padding:0; background:none; border:none;">Pico AutoInput Editor へようこそ</h2>
                <span class="close-btn" id="close-help-btn">&times;</span>
            </div>
            <div class="modal-body">
                <p><b>Pico AutoInput</b> は、あなたの代わりにキーボードやマウスを操作してくれる自動化デバイスです。</p>

                <h3 class="help-h3">🔘 2つのボタンの使い分け</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px; background: #eef; padding: 15px; border-radius: 8px; border: 2px solid #ccd;">
                        <strong style="font-size: 1.1em;">⚫ 黒いボタン (決定・開始)</strong>
                        <ul style="margin: 5px 0 0 0; padding-left: 20px;">
                            <li><b>スクリプトを動かす:</b> 準備ができたら「カチッ」と1回押します。</li>
                            <li><b>設定をリセットする:</b> 緑ランプのときに10秒長押しします。</li>
                            <li><b>中身を書き換える:</b> このボタンを押しながらPCに繋ぐと、ファームウェア更新モードになります。</li>
                        </ul>
                    </div>
                    <div style="flex: 1; min-width: 200px; background: #fee; padding: 15px; border-radius: 8px; border: 2px solid #dcc;">
                        <strong style="font-size: 1.1em;">⚪ 白いボタン (再起動)</strong>
                        <ul style="margin: 5px 0 0 0; padding-left: 20px;">
                            <li><b>やり直す:</b> 押すと電源が切れ、すぐ再起動します。<br>（ケーブルを抜き差しするのと同じ効果です）</li>
                            <li><b>緊急停止:</b> 動いているスクリプトをすぐに止めたい時に押します。</li>
                        </ul>
                    </div>
                </div>

                <h3 class="help-h3">🔰 初めての方へ：失敗しないための5つのポイント</h3>
                <div style="background:#fff3cd; border:1px solid #ffeeba; padding:15px; border-radius:5px; color:#856404;">
                    <ul style="margin:0; padding-left:20px;">
                        <li style="margin-bottom:10px;">
                            <b>🔌 ケーブルは「通信対応」のものを使う</b><br>
                            100円ショップなどで売られている「充電専用」のケーブルでは動きません。スマートフォンとPCを繋いで写真が転送できるような<b>「データ通信対応」のUSBケーブル</b>（Type-C）を必ずご用意ください。
                        </li>
                        <li style="margin-bottom:10px;">
                            <b>📄 ファイル名は「Script.txt」にする</b><br>
                            保存する際、ファイル名は正確に <code>Script.txt</code> にしてください。<br>
                            <span style="font-size:0.9em; color:#d9534f;">※注意: PCの設定によっては、後ろの <code>.txt</code> が隠れている場合があります。その場合、<code>Script</code> とだけ名前を付けて保存してください（<code>Script.txt.txt</code> になると動きません）。</span>
                        </li>
                        <li style="margin-bottom:10px;">
                            <b>📂 保存場所は「一番上の階層」へ</b><br>
                            PCに繋ぐとUSBメモリのように認識されます。フォルダを作らず、開いた場所に直接ファイルを置いてください。
                        </li>
                        <li style="margin-bottom:10px;">
                            <b>📺 画面を準備してから「黒ボタン」を押す</b><br>
                            このデバイスは画面が見えていません。<b>黒いボタン</b>を押す前に、操作したい画面（ゲームやExcelなど）を必ず手前に出しておいてください。
                        </li>
                        <li>
                            <b>🛑 困ったら「白ボタン」またはケーブルを抜く</b><br>
                            予期しない動きをして止めたい場合は、落ち着いて<b>白いボタン</b>を押すか、USBケーブルを抜いてください。完全に停止します。
                        </li>
                    </ul>
                </div>

                <h3 class="help-h3">🎨 エディタ画面の見方と便利機能</h3>
                
                <p style="margin-bottom:10px;"><b>1. 文字の色（シンタックスハイライト）</b></p>
                <ul>
                    <li><span class="legend-box legend-func"></span><b style="color:#008000">緑色 (命令)</b> : 
                        <code>WAIT</code> や <code>KeyPress</code> など、PCへの命令です。ここが黒色のままだとスペルミスの可能性があります。
                    </li>
                    <li><span class="legend-box legend-var"></span><b style="color:#a52a2a">茶色 (名前)</b> : 
                        <code>Loop</code> や <code>i</code> など、自分で決めた名前（ラベルや変数）です。
                    </li>
                    <li><span class="legend-box legend-arg"></span><b style="color:#d4a017">黄色 (設定値)</b> : 
                        <code>0.5</code> や <code>LEFT</code> など、命令の具体的な内容です。
                    </li>
                    <li><span class="legend-box legend-other"></span><b style="color:#0000ff">青色 (メモ)</b> : 
                        <code>REM</code> で始まる行は「コメント」として無視されます。
                    </li>
                </ul>

                <p style="margin-top:15px; margin-bottom:10px;"><b>2. 間違い探し機能（エラー表示）</b></p>
                <ul>
                    <li>
                        <span style="display:inline-block; width:12px; height:12px; background:#ffcccc; border:1px solid #f88; margin-right:5px; vertical-align:middle;"></span>
                        <strong>赤色の背景 (エラー)</strong> : 
                        「スペルミス」「カッコの閉じ忘れ」など、<b style="color:#d32f2f;">このままでは動かない重大なミス</b>です。
                    </li>
                    <li>
                        <span style="display:inline-block; width:12px; height:12px; background:#fff8c4; border:1px solid #e6a800; margin-right:5px; vertical-align:middle;"></span>
                        <strong>黄色の背景 (警告)</strong> : 
                        文法は合っていますが、「数字が変」など、意図しない動作になる可能性がある箇所です。
                    </li>
                </ul>

                <p style="margin-top:15px; margin-bottom:10px;"><b>3. 入力サポート機能</b></p>
                <ul>
                    <li><b>入力補完 (定数オートコンプリート):</b><br>
                        コマンドのカッコ <code>(</code> 内で文字を入力すると、そこで使える<b>「定数（キーの名前など）」</b>の候補リストが出ます。<br>
                        <span style="font-size:0.9em; color:#666;">例: <code>KeyPress(</code> の中で <code>S</code> と打つと、<code>SHIFT</code> や <code>SPACE</code> が候補に出ます。（※コマンド名の補完ではありません）</span>
                    </li>
                    <li><b>ラベル補完:</b><br>
                        <code>GOTO</code> の後ろなどで、すでに作った「ラベルの名前」が候補に出るので、簡単に指定できます。
                    </li>
                    <li><b>リファレンス (右パネル):</b><br>
                        コマンドをクリックするとエディタに挿入されます。「▼」で詳しい使い方とサンプルが見れます。
                    </li>
                </ul>

                <h3 class="help-h3">💡 LEDの色と状態</h3>
                <ul>
                    <li><b>LEDの意味:</b>
                        <ul>
                            <li><b style="color:green">緑色</b> : <b>待機中 (準備OK)</b><br>PCに接続され、<b>黒ボタン</b>が押されるのを待っている状態です。</li>
                            <li><b style="color:#d4a017">黄色</b> : <b>実行中</b><br>スクリプトが動作しています（色の指定がない場合の基本色）。</li>
                            <li><b style="color:purple">紫色 (点滅)</b> : <b>エラー発生</b><br>スクリプトの内容に間違いがあり停止しました。ドライブ内の <code>error_log.txt</code> に原因が書かれています。</li>
                            <li><b>白色</b> : <b>初期化中</b><br>ストレージをリセットしています。絶対にケーブルを抜かないでください。</li>
                            <li><b style="color:red">赤色 (点滅)</b> : <b>起動準備中</b><br>PCに繋いだ直後の状態です。起動に連続で失敗すると点滅回数が増えます。</li>
                        </ul>
                    </li>
                    <li><b>強制初期化 (工場出荷時に戻す):</b><br>
                        動かなくなった場合、以下の手順でリセットできます。
                        <ul>
                            <li><b>黒ボタン長押しリセット:</b><br>
                                LEDが <b style="color:green">緑色</b> のときに、<b>黒いボタン</b> を <b>10秒間長押し</b> すると初期化されます。
                            </li>
                            <li><b>連続起動失敗リセット:</b><br>
                                PCに接続して <b style="color:red">赤色</b> が点滅している間に「<b>白いボタン</b>を押して再起動する」操作を <b>3回連続</b> で行うと、次回起動時に自動的に初期化されます。<br>
                                ※失敗カウントがたまると、起動時の赤点滅の回数がだんだん増えます。
                            </li>
                        </ul>
                    </li>
                    <li><b>【重要】接続時の注意:</b><br>
                        PCに接続した直後の <b style="color:red">赤点滅</b> は、準備運動のようなものです。ここで電源を切ると「起動失敗」とカウントされてしまい、意図せず初期化される原因になります。<br>
                        <b>赤点滅が終わって緑色になるまで（約10秒）、ボタンを押さずにお待ちください。</b>
                    </li>
                </ul>

                <h3 class="help-h3">📝 サンプルの使い方</h3>
                <ol>
                    <li>この画面（エディタ）で作りたい動作を選んだり、書いたりします。</li>
                    <li>右上の「<b>保存</b>」ボタンを押し、<code>Script.txt</code> という名前でPCに保存します。</li>
                    <li>Pico AutoInput をPCに接続し、出てきたドライブの中に <code>Script.txt</code> を入れます。</li>
                    <li>操作したい画面を開いてから、本体の <b>黒いボタン</b> を「カチッ」と1回押すとスタートします。</li>
                </ol>

                <h3 class="help-h3">ファームウェアの更新方法</h3>
                <ol>
                    <li>最新のファームウェア (<code>.uf2</code> ファイル) を入手します。<br>
                        配布URL: <a href="#" class="help-link" onclick="alert('https://github.com/akaharaimori/Pico_AutoInput/releases')">[こちらをクリックしてダウンロード]</a></li>
                    <li>PicoをPCから取り外します。</li>
                    <li>Pico本体の <b>黒いボタン</b> を<b>押したまま</b>、USBケーブルでPCに接続します。</li>
                    <li>"RPI-RP2" というドライブが認識されたらボタンを離します。</li>
                    <li><code>.uf2</code> ファイルをそのドライブにドラッグ＆ドロップします。自動的に再起動して更新完了です。</li>
                </ol>

                <h3 class="help-h3">オープンソースライセンス</h3>
                <p style="font-size: 0.85rem; color: #666;">
                    本ソフトウェアは、以下のオープンソースソフトウェアを含んでいます。
                </p>
                <ul style="font-size: 0.85rem; color: #666;">
                    <li><b>TinyUSB</b> (MIT License) - Copyright (c) 2019 Ha Thach (tinyusb.org)</li>
                    <li><b>TinyExpr++</b> (Zlib License) - Copyright (c) 2020-2025 Blake Madden</li>
                    <li><b>Pico SDK</b> (BSD-3-Clause) - Copyright (c) 2020 Raspberry Pi (Trading) Ltd.</li>
                    <li><b>Mermaid.js</b> (MIT License) - Copyright (c) 2014-2023 Knut Sveidqvist</li>
                    <li><b>Vite</b> (MIT License) - Copyright (c) 2019-present Evan You & Vite Contributors</li>
                    <li><b>SwitchControllerPico</b> (MIT License) - Copyright (c) 2023 sorasen2020</li>
                    <li><b>PNGdec</b> (Apache-2.0) - Copyright 2020 BitBank Software, Inc.</li>
                    <li><b>LittleFS</b> (BSD-3-Clause) - Copyright (c) 2017 Arm Limited, 2022 The littlefs authors</li>
                    <li><b>TinyUSB_Mouse_and_Keyboard</b> (MIT License) - Copyright (c) 2020 Chris Young</li>
                    <li><b>pico-littlefs-usb</b> (BSD-3-Clause) - Copyright 2024 Hiroyuki OYAMA</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="container">
        <div id="editor-pane">
            <div id="toolbar">
                <span style="font-weight:bold;">Pico AutoInput Editor v1.0</span>
                <button class="tool-btn" id="btn-open">📂 開く</button>
                <input type="file" id="file-input" accept=".txt" style="display:none">
                <button class="tool-btn" id="btn-save">💾 保存</button>
                <button class="tool-btn" id="btn-help">❓ 使い方</button>
                <label class="toggle-label" style="margin-left:auto;">
                    <input type="checkbox" id="chk-errors" checked>
                    <span>⚠️ エラー表示</span>
                </label>
            </div>
            <div id="status-area">準備完了</div>

            <div id="editor-wrapper">
                <pre id="code-highlight" class="editor-layer"></pre>
                <textarea id="code-input" class="editor-layer" spellcheck="false"
                    placeholder="// ここにスクリプトを入力してください..."></textarea>
                <div id="autocomplete-list"></div>
            </div>
        </div>

        <div id="info-pane">
            <div class="tab-bar">
                <div class="tab active" data-tab="reference">リファレンス</div>
                <div class="tab" data-tab="structure">構造解析</div>
                <div class="tab" data-tab="flowchart">フローチャート</div>
                <div class="tab" data-tab="samples">サンプル</div>
            </div>
            <div id="samples" class="tab-content">
            </div>

            <div id="reference" class="tab-content active">
                <p style="font-size:0.85rem; color:#666; margin:0 0 15px 0; background:#fff8c4; padding:5px;">
                    ※ クリックするとカーソル位置に挿入されます。<br>
                    ※ 「▼」で詳細・サンプルを表示します。<br>
                    ※ <code>expr</code> は数式や数値を意味します。
                </p>

                <div class="doc-section">
                    <h2>基本コマンド</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="WAIT 1.0"><span class="doc-syntax">WAIT expr</span>
                                <div class="doc-desc">指定秒数待機します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                指定した秒数（<code>double</code>型、実数）だけスクリプトの実行を一時停止します。<br>
                                <b>動作:</b> 指定時間は何も操作を行わず待機します。直前のキー押しっぱなし状態などは維持されます。<br>
                                <b>引数:</b> 待機する秒数（正の数）。0以下は待機しません。
                            </div>
                            <div class="detail-sample">
REM 1.5秒間何もしない
WAIT 1.5

REM 変数を使った待機（0.1秒～0.5秒のランダム待機）
WAIT Rand(0.1, 0.5)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="END"><span class="doc-syntax">END</span>
                                <div class="doc-desc">実行を終了します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                スクリプトの実行を完全に終了させます。<br>
                                <b>動作:</b> これ以降の行は実行されず、デバイスは待機状態になります。再実行するには本体ボタンを押す必要があります。
                            </div>
                            <div class="detail-sample">
SET count = 0
LABEL Loop
SET count = count + 1
PRINT count
REM 5回ループしたら終了 (&gt; は大なり)
IF count &gt; 5 GOTO Finish
WAIT 1
GOTO Loop

LABEL Finish
PRINT "完了"
END
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="PRINT expr"><span class="doc-syntax">PRINT expr</span>
                                <div class="doc-desc">ログ出力します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                変数や計算結果の値をログファイル（log.txt）とシリアルモニタに出力します。<br>
                                <b>動作:</b> <code>PRINT: 123.456</code> のような形式で記録されます。デバッグや変数の確認に使います。<br>
                                <b>注意:</b> 出力できるのは数値のみです。文字列の出力には対応していません。
                            </div>
                            <div class="detail-sample">
SET hp = 100
SET damage = Rand(10, 20)
SET hp = hp - damage

REM 計算結果を確認（例: PRINT: 85.0）
PRINT hp

REM 押されていれば1.0、そうでなければ0.0が出る
PRINT IsPressed()
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h2>制御フロー (分岐・ループ)</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="LABEL Name"><span class="doc-syntax">LABEL Name</span>
                                <div class="doc-desc">ラベルを定義します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                ジャンプ先となる目印（ラベル）を作成します。<br>
                                <b>動作:</b> 実行時は何もせず、次の行へ進みます。<code>GOTO</code> や <code>GOSUB</code> の行き先として使われます。<br>
                                <b>引数:</b> 任意の名前（英数字推奨）。大文字小文字は区別されます。
                            </div>
                            <div class="detail-sample">
LABEL LoopStart
PRINT "ここはループの先頭です"
WAIT 1
GOTO LoopStart
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="GOTO Name"><span class="doc-syntax">GOTO Name</span>
                                <div class="doc-desc">ラベルへジャンプします。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                指定したラベルの行へ処理を移動させます。<br>
                                <b>動作:</b> 無条件に移動します。無限ループを作る際などに使用します。
                            </div>
                            <div class="detail-sample">
REM SkipTargetへ飛び、間の行を飛ばす
GOTO SkipTarget

PRINT "この行は実行されません"

LABEL SkipTarget
PRINT "ジャンプしました"
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="IF expr GOTO Name"><span class="doc-syntax">IF expr GOTO Name</span>
                                <div class="doc-desc">条件分岐します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                条件式が満たされた場合のみジャンプします。<br>
                                <b>動作:</b> <code>expr</code> の結果が 0.0 以外（真）なら指定ラベルへジャンプ。0.0（偽）なら次の行へ進みます。
                            </div>
                            <div class="detail-sample">
SET count = 0
LABEL Loop
SET count = count + 1

REM countが3未満(真)ならLoopへ戻る (&lt; は小なり)
IF count &lt; 3 GOTO Loop

PRINT "3回ループしました"
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="GOSUB Name"><span class="doc-syntax">GOSUB Name</span>
                                <div class="doc-desc">サブルーチンを呼びます。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                現在の場所を記憶してラベルへジャンプし、処理を委譲します。<br>
                                <b>動作:</b> <code>RETURN</code> コマンドに出会うと、この <code>GOSUB</code> の次の行に戻ってきます。共通処理の使い回しに便利です。
                            </div>
                            <div class="detail-sample">
PRINT "メイン処理開始"
GOSUB MyTask
PRINT "メイン処理終了"
END

LABEL MyTask
PRINT "  サブ処理実行中..."
WAIT 0.5
RETURN
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="RETURN"><span class="doc-syntax">RETURN</span>
                                <div class="doc-desc">サブルーチンから戻ります。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                サブルーチンを終了し、呼び出し元に戻ります。<br>
                                <b>動作:</b> 直前の <code>GOSUB</code> の次の行へジャンプします。<code>GOSUB</code> を経由せずに実行するとエラーになります。
                            </div>
                            <div class="detail-sample">
REM (GOSUBのサンプルを参照)
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h2>変数・設定</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="SET var = expr"><span class="doc-syntax">SET var = expr</span>
                                <div class="doc-desc">変数に値を代入します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                計算結果を変数に保存します。<br>
                                <b>動作:</b> 変数 <code>var</code> がなければ新規作成し、あれば値を上書きします。変数はすべて小数（double型）として扱われます。<br>
                                <b>引数:</b> 変数名（英数字）、代入する式。
                            </div>
                            <div class="detail-sample">
SET a = 10
SET b = 20
SET c = (a + b) * 2
PRINT c
REM 出力: 60.0

REM フラグの反転 (0 -> 1, 1 -> 0)
SET flag = not(flag)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="Mode(KeyMouse)"><span class="doc-syntax">Mode(ModeName)</span>
                                <div class="doc-desc">USBモードを切り替えます。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                デバイスのUSB動作モードを変更します。<br>
                                <b>動作:</b> 実行するとUSB接続がリセットされ、PCに再認識されます。モードに応じたコマンドしか使えなくなります。<br>
                                <b>引数:</b>
                                <ul>
                                    <li><code>KeyMouse</code>: キーボード・マウスモード（初期値）。</li>
                                    <li><code>ProController</code>: Switch Proコンモード。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM Switchモードに切り替え
Mode(ProController)
WAIT 3.0
REM Aボタンを押す
ProConPushFor(A, 0.1)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="LogConfig(50, OVERWRITE)"><span class="doc-syntax">LogConfig(size, mode)</span>
                                <div class="doc-desc">ログ設定を変更します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                ルートディレクトリの <code>log.txt</code> の挙動を設定します。<br>
                                <b>動作:</b> ファイルサイズが指定値を超えた場合の処理を決定します。<br>
                                <b>引数:</b>
                                <ul>
                                    <li><code>size</code>: 最大キロバイト数(KB)。0を指定するとログ停止。</li>
                                    <li><code>mode</code>: <code>OVERWRITE</code>（古いログを.bakにして新規作成）、<code>STOP</code>（記録停止）。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM 100KBまで記録し、超えたらローテーション(上書き)
LogConfig(100, OVERWRITE)

REM ログ記録を停止（高速化・寿命延命）
LogConfig(0, STOP)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="DEBUG(1)"><span class="doc-syntax">DEBUG(enable)</span>
                                <div class="doc-desc">デバッグ出力を制御します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                詳細な実行ログの出力を切り替えます。<br>
                                <b>動作:</b> 有効にすると、実行中の行内容が逐一ログに記録されます。開発中は便利ですが、動作が遅くなるため完成後は無効にしてください。<br>
                                <b>引数:</b> <code>1</code> (有効), <code>0</code> (無効)
                            </div>
                            <div class="detail-sample">
DEBUG(1)
PRINT "ここから詳細ログが出ます"
SET a = 1
DEBUG(0)
                            </div>
                        </div>
                    </div>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="UseLED(1)"><span class="doc-syntax">UseLED(enable)</span>
                                <div class="doc-desc">LED制御を有効化します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                内蔵フルカラーLEDの制御権を取得します。<br>
                                <b>動作:</b> 有効にすると <code>SetLED</code> が反映されるようになります。<br>
                                <b>引数:</b> <code>1</code> (有効), <code>0</code> (無効)
                            </div>
                            <div class="detail-sample">
UseLED(1)
SetLED(255, 0, 0)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="SetLED(255,0,0)"><span class="doc-syntax">SetLED(r, g, b)</span>
                                <div class="doc-desc">LEDの色を設定します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                内蔵LEDを指定した色で点灯させます。<br>
                                <b>動作:</b> 即座に色が変更されます。<code>UseLED(1)</code> が必要です。<br>
                                <b>引数:</b> 赤(r), 緑(g), 青(b) の強さを 0～255 で指定。
                            </div>
                            <div class="detail-sample">
UseLED(1)
REM 赤点灯
SetLED(255, 0, 0)
WAIT 0.5
REM 緑点灯
SetLED(0, 255, 0)
WAIT 0.5
REM 消灯
SetLED(0, 0, 0)
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h2>キーボード・マウス (KeyMouseモード)</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="KeyPress(ENTER)"><span class="doc-syntax">KeyPress(key)</span>
                                <div class="doc-desc">キーを押しっぱなしにします。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                キーボードのキーを押した状態にします。<br>
                                <b>動作:</b> <code>KeyRelease</code> が呼ばれるまで、PCには「キーが押され続けている」という信号が送られます。<br>
                                <b>引数:</b>
                                <ul>
                                    <li>定義済み定数: <code>ENTER</code>, <code>SPACE</code>, <code>SHIFT</code>, <code>F1</code> など。</li>
                                    <li>1文字: <code>A</code>, <code>a</code>, <code>1</code>, <code>@</code> など（キーボード上の文字）。</li>
                                    <li>文字列リテラル: <code>"Hello"</code> (各文字を順に押しますが、KeyPressの場合は最後の文字が押された状態になります)。</li>
                                </ul>
                            </div>
                            
                            <div class="sub-doc-entry">
                                <div class="sub-doc-header">
                                    <span>定義済みキー定数対応表</span>
                                    <span class="sub-toggle-icon">▼</span>
                                </div>
                                <div class="sub-doc-detail">
                                    <p style="margin:5px 0; color:#666; font-size:0.8rem;">
                                        ※ 1文字の英数字・記号（<code>A</code>, <code>1</code>, <code>!</code>, <code>@</code>など）は定数を使わずに直接記述可能です。
                                    </p>
                                    <table class="key-table">
                                        <thead>
                                            <tr>
                                                <th style="width: 25%;">カテゴリー</th>
                                                <th style="width: 40%;">定数名 (エイリアス)</th>
                                                <th style="width: 35%;">対応するキー / 説明</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><b>英数字</b></td>
                                                <td><span class="key-code">a-z, A-Z, 0-9</span></td>
                                                <td>英字(A-Z), 数字(0-9)</td>
                                            </tr>

                                            <tr>
                                                <td><b>ファンクション</b></td>
                                                <td><span class="key-code">F1 - F12</span></td>
                                                <td>F1 ～ F12 キー</td>
                                            </tr>

                                            <tr>
                                                <td rowspan="6"><b>制御・編集</b></td>
                                                <td><span class="key-code">ENTER, RETURN</span></td>
                                                <td>Enter (リターン)</td>
                                            </tr>
                                            <tr><td><span class="key-code">ESC, ESCAPE</span></td><td>Esc (エスケープ)</td></tr>
                                            <tr><td><span class="key-code">BACKSPACE, BKSP</span></td><td>Backspace</td></tr>
                                            <tr><td><span class="key-code">TAB</span></td><td>Tab</td></tr>
                                            <tr><td><span class="key-code">SPACE, SPACEBAR</span></td><td>Space (空白)</td></tr>
                                            <tr><td><span class="key-code">CAPSLOCK, CAPS</span></td><td>CapsLock</td></tr>

                                            <tr>
                                                <td rowspan="5"><b>移動・削除</b></td>
                                                <td><span class="key-code">UP, DOWN, LEFT, RIGHT</span></td>
                                                <td>矢印 (↑, ↓, ←, →)<br><span style="font-size:0.75em; color:#888">ARROWUP, ARROWDOWN...</span></td>
                                            </tr>
                                            <tr><td><span class="key-code">PGUP, PGDN</span></td><td>PageUp, PageDown<br><span style="font-size:0.75em; color:#888">PAGEUP, PAGEDOWN</span></td></tr>
                                            <tr><td><span class="key-code">HOME, END</span></td><td>Home, End</td></tr>
                                            <tr><td><span class="key-code">INSERT, INS</span></td><td>Insert</td></tr>
                                            <tr><td><span class="key-code">DELETE, DEL</span></td><td>Delete</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>システム</b></td>
                                                <td><span class="key-code">PRINTSCREEN, PRTSC</span></td>
                                                <td>PrintScreen</td>
                                            </tr>
                                            <tr><td><span class="key-code">SCROLLLOCK</span></td><td>ScrollLock</td></tr>
                                            <tr><td><span class="key-code">PAUSE, BREAK</span></td><td>Pause / Break</td></tr>
                                            <tr><td><span class="key-code">NUMLOCK</span></td><td>NumLock</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>修飾キー</b></td>
                                                <td><span class="key-code">CTRL, LCTRL, RCTRL</span></td>
                                                <td>Ctrl (左右)</td>
                                            </tr>
                                            <tr><td><span class="key-code">SHIFT, LSHIFT, RSHIFT</span></td><td>Shift (左右)</td></tr>
                                            <tr><td><span class="key-code">ALT, LALT, RALT</span></td><td>Alt (左右)</td></tr>
                                            <tr><td><span class="key-code">WIN, GUI, CMD</span></td><td>Windows / Command (左右)</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>日本語キー</b></td>
                                                <td><span class="key-code">HENKAN</span></td>
                                                <td>変換</td>
                                            </tr>
                                            <tr><td><span class="key-code">MUHENKAN</span></td><td>無変換</td></tr>
                                            <tr><td><span class="key-code">ZENKAKU, HANKAKU</span></td><td>全角/半角 (ZENKAKUHANKAKU)</td></tr>
                                            <tr><td><span class="key-code">KATAKANA, HIRAGANA</span></td><td>カタカナ/ひらがな</td></tr>

                                            <tr>
                                                <td rowspan="14"><b>記号</b><br><span style="font-size:0.8em; font-weight:normal">直接入力可</span></td>
                                                <td><span class="key-code">EXCLAMATION</span></td><td><b>!</b> (感嘆符)</td>
                                            </tr>
                                            <tr><td><span class="key-code">DOUBLEQUOTE</span></td><td><b>"</b> (二重引用符)</td></tr>
                                            <tr><td><span class="key-code">HASH</span></td><td><b>#</b> (井桁)</td></tr>
                                            <tr><td><span class="key-code">DOLLAR</span></td><td><b>$</b> (ドル)</td></tr>
                                            <tr><td><span class="key-code">PERCENT</span></td><td><b>%</b> (パーセント)</td></tr>
                                            <tr><td><span class="key-code">AMPERSAND</span></td><td><b>&amp;</b> (アンパサンド)</td></tr>
                                            <tr><td><span class="key-code">APOSTROPHE</span></td><td><b>'</b> (シングルクォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTPAREN, RIGHTPAREN</span></td><td><b>( )</b> (小括弧)</td></tr>
                                            <tr><td><span class="key-code">ASTERISK, MUL</span></td><td><b>*</b> (アスタリスク)</td></tr>
                                            <tr><td><span class="key-code">PLUS, ADD</span></td><td><b>+</b> (プラス)</td></tr>
                                            <tr><td><span class="key-code">COMMA, DOT</span></td><td><b>, .</b> (カンマ, ドット)</td></tr>
                                            <tr><td><span class="key-code">MINUS</span></td><td><b>-</b> (マイナス)</td></tr>
                                            <tr><td><span class="key-code">SLASH, BACKSLASH</span></td><td><b>/ \</b> (スラッシュ, バックスラッシュ)</td></tr>
                                            <tr><td><span class="key-code">COLON, SEMICOLON</span></td><td><b>: ;</b> (コロン, セミコロン)</td></tr>
                                            <tr><td><span class="key-code">LESS, GREATER</span></td><td><b>&lt; &gt;</b> (小なり, 大なり)</td></tr>
                                            <tr><td><span class="key-code">EQUAL</span></td><td><b>=</b> (イコール)</td></tr>
                                            <tr><td><span class="key-code">QUESTION</span></td><td><b>?</b> (疑問符)</td></tr>
                                            <tr><td><span class="key-code">AT</span></td><td><b>@</b> (アットマーク)</td></tr>
                                            <tr><td><span class="key-code">LEFTBRACE, RIGHTBRACE</span></td><td><b>[ ]</b> (大括弧)</td></tr>
                                            <tr><td><span class="key-code">CARET</span></td><td><b>^</b> (キャレット)</td></tr>
                                            <tr><td><span class="key-code">UNDERSCORE</span></td><td><b>_</b> (アンダースコア)</td></tr>
                                            <tr><td><span class="key-code">GRAVE</span></td><td><b>`</b> (バッククォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTCURLY, RIGHTCURLY</span></td><td><b>{ }</b> (中括弧)</td></tr>
                                            <tr><td><span class="key-code">PIPE, BAR</span></td><td><b>|</b> (縦棒)</td></tr>
                                            <tr><td><span class="key-code">TILDE</span></td><td><b>~</b> (チルダ)</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="detail-sample">
REM SHIFTキーを押す
KeyPress(SHIFT)
REM 'a' キーを押す (SHIFT中なので 'A' になる)
KeyPress(a)
WAIT 0.1
REM 両方離す
KeyRelease(a)
KeyRelease(SHIFT)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="KeyRelease(ENTER)"><span class="doc-syntax">KeyRelease(key)</span>
                                <div class="doc-desc">キーを離します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                押されているキーを離した状態にします。<br>
                                <b>引数:</b> <code>KeyPress</code> と同様に、定数・1文字・文字列が使用可能です。
                            </div>
                            <div class="sub-doc-entry">
                                <div class="sub-doc-header">
                                    <span>定義済みキー定数対応表</span>
                                    <span class="sub-toggle-icon">▼</span>
                                </div>
                                <div class="sub-doc-detail">
                                    <p style="margin:5px 0; color:#666; font-size:0.8rem;">
                                        ※ 1文字の英数字・記号（<code>A</code>, <code>1</code>, <code>!</code>, <code>@</code>など）は定数を使わずに直接記述可能です。
                                    </p>
                                    <table class="key-table">
                                        <thead>
                                            <tr>
                                                <th style="width: 25%;">カテゴリー</th>
                                                <th style="width: 40%;">定数名 (エイリアス)</th>
                                                <th style="width: 35%;">対応するキー / 説明</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><b>英数字</b></td>
                                                <td><span class="key-code">a-z, A-Z, 0-9</span></td>
                                                <td>英字(A-Z), 数字(0-9)</td>
                                            </tr>

                                            <tr>
                                                <td><b>ファンクション</b></td>
                                                <td><span class="key-code">F1 - F12</span></td>
                                                <td>F1 ～ F12 キー</td>
                                            </tr>

                                            <tr>
                                                <td rowspan="6"><b>制御・編集</b></td>
                                                <td><span class="key-code">ENTER, RETURN</span></td>
                                                <td>Enter (リターン)</td>
                                            </tr>
                                            <tr><td><span class="key-code">ESC, ESCAPE</span></td><td>Esc (エスケープ)</td></tr>
                                            <tr><td><span class="key-code">BACKSPACE, BKSP</span></td><td>Backspace</td></tr>
                                            <tr><td><span class="key-code">TAB</span></td><td>Tab</td></tr>
                                            <tr><td><span class="key-code">SPACE, SPACEBAR</span></td><td>Space (空白)</td></tr>
                                            <tr><td><span class="key-code">CAPSLOCK, CAPS</span></td><td>CapsLock</td></tr>

                                            <tr>
                                                <td rowspan="5"><b>移動・削除</b></td>
                                                <td><span class="key-code">UP, DOWN, LEFT, RIGHT</span></td>
                                                <td>矢印 (↑, ↓, ←, →)<br><span style="font-size:0.75em; color:#888">ARROWUP, ARROWDOWN...</span></td>
                                            </tr>
                                            <tr><td><span class="key-code">PGUP, PGDN</span></td><td>PageUp, PageDown<br><span style="font-size:0.75em; color:#888">PAGEUP, PAGEDOWN</span></td></tr>
                                            <tr><td><span class="key-code">HOME, END</span></td><td>Home, End</td></tr>
                                            <tr><td><span class="key-code">INSERT, INS</span></td><td>Insert</td></tr>
                                            <tr><td><span class="key-code">DELETE, DEL</span></td><td>Delete</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>システム</b></td>
                                                <td><span class="key-code">PRINTSCREEN, PRTSC</span></td>
                                                <td>PrintScreen</td>
                                            </tr>
                                            <tr><td><span class="key-code">SCROLLLOCK</span></td><td>ScrollLock</td></tr>
                                            <tr><td><span class="key-code">PAUSE, BREAK</span></td><td>Pause / Break</td></tr>
                                            <tr><td><span class="key-code">NUMLOCK</span></td><td>NumLock</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>修飾キー</b></td>
                                                <td><span class="key-code">CTRL, LCTRL, RCTRL</span></td>
                                                <td>Ctrl (左右)</td>
                                            </tr>
                                            <tr><td><span class="key-code">SHIFT, LSHIFT, RSHIFT</span></td><td>Shift (左右)</td></tr>
                                            <tr><td><span class="key-code">ALT, LALT, RALT</span></td><td>Alt (左右)</td></tr>
                                            <tr><td><span class="key-code">WIN, GUI, CMD</span></td><td>Windows / Command (左右)</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>日本語キー</b></td>
                                                <td><span class="key-code">HENKAN</span></td>
                                                <td>変換</td>
                                            </tr>
                                            <tr><td><span class="key-code">MUHENKAN</span></td><td>無変換</td></tr>
                                            <tr><td><span class="key-code">ZENKAKU, HANKAKU</span></td><td>全角/半角 (ZENKAKUHANKAKU)</td></tr>
                                            <tr><td><span class="key-code">KATAKANA, HIRAGANA</span></td><td>カタカナ/ひらがな</td></tr>

                                            <tr>
                                                <td rowspan="14"><b>記号</b><br><span style="font-size:0.8em; font-weight:normal">直接入力可</span></td>
                                                <td><span class="key-code">EXCLAMATION</span></td><td><b>!</b> (感嘆符)</td>
                                            </tr>
                                            <tr><td><span class="key-code">DOUBLEQUOTE</span></td><td><b>"</b> (二重引用符)</td></tr>
                                            <tr><td><span class="key-code">HASH</span></td><td><b>#</b> (井桁)</td></tr>
                                            <tr><td><span class="key-code">DOLLAR</span></td><td><b>$</b> (ドル)</td></tr>
                                            <tr><td><span class="key-code">PERCENT</span></td><td><b>%</b> (パーセント)</td></tr>
                                            <tr><td><span class="key-code">AMPERSAND</span></td><td><b>&amp;</b> (アンパサンド)</td></tr>
                                            <tr><td><span class="key-code">APOSTROPHE</span></td><td><b>'</b> (シングルクォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTPAREN, RIGHTPAREN</span></td><td><b>( )</b> (小括弧)</td></tr>
                                            <tr><td><span class="key-code">ASTERISK, MUL</span></td><td><b>*</b> (アスタリスク)</td></tr>
                                            <tr><td><span class="key-code">PLUS, ADD</span></td><td><b>+</b> (プラス)</td></tr>
                                            <tr><td><span class="key-code">COMMA, DOT</span></td><td><b>, .</b> (カンマ, ドット)</td></tr>
                                            <tr><td><span class="key-code">MINUS</span></td><td><b>-</b> (マイナス)</td></tr>
                                            <tr><td><span class="key-code">SLASH, BACKSLASH</span></td><td><b>/ \</b> (スラッシュ, バックスラッシュ)</td></tr>
                                            <tr><td><span class="key-code">COLON, SEMICOLON</span></td><td><b>: ;</b> (コロン, セミコロン)</td></tr>
                                            <tr><td><span class="key-code">LESS, GREATER</span></td><td><b>&lt; &gt;</b> (小なり, 大なり)</td></tr>
                                            <tr><td><span class="key-code">EQUAL</span></td><td><b>=</b> (イコール)</td></tr>
                                            <tr><td><span class="key-code">QUESTION</span></td><td><b>?</b> (疑問符)</td></tr>
                                            <tr><td><span class="key-code">AT</span></td><td><b>@</b> (アットマーク)</td></tr>
                                            <tr><td><span class="key-code">LEFTBRACE, RIGHTBRACE</span></td><td><b>[ ]</b> (大括弧)</td></tr>
                                            <tr><td><span class="key-code">CARET</span></td><td><b>^</b> (キャレット)</td></tr>
                                            <tr><td><span class="key-code">UNDERSCORE</span></td><td><b>_</b> (アンダースコア)</td></tr>
                                            <tr><td><span class="key-code">GRAVE</span></td><td><b>`</b> (バッククォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTCURLY, RIGHTCURLY</span></td><td><b>{ }</b> (中括弧)</td></tr>
                                            <tr><td><span class="key-code">PIPE, BAR</span></td><td><b>|</b> (縦棒)</td></tr>
                                            <tr><td><span class="key-code">TILDE</span></td><td><b>~</b> (チルダ)</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="detail-sample">
REM (KeyPressのサンプルを参照)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="KeyPushFor(A, 0.1)"><span class="doc-syntax">KeyPushFor(key, sec)</span>
                                <div class="doc-desc">指定時間キーを押します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                キーを一回ポンと押す動作を行います。<br>
                                <b>動作:</b> <code>KeyPress</code> → 指定秒数待機 → <code>KeyRelease</code> を自動で行います。<br>
                                <b>引数:</b> キー（定数/文字/文字列）, 押す時間(秒)。
                            </div>
                            
                            <div class="sub-doc-entry">
                                <div class="sub-doc-header">
                                    <span>定義済みキー定数対応表</span>
                                    <span class="sub-toggle-icon">▼</span>
                                </div>
                                <div class="sub-doc-detail">
                                    <p style="margin:5px 0; color:#666; font-size:0.8rem;">
                                        ※ 1文字の英数字・記号（<code>A</code>, <code>1</code>, <code>!</code>, <code>@</code>など）は定数を使わずに直接記述可能です。
                                    </p>
                                    <table class="key-table">
                                        <thead>
                                            <tr>
                                                <th style="width: 25%;">カテゴリー</th>
                                                <th style="width: 40%;">定数名 (エイリアス)</th>
                                                <th style="width: 35%;">対応するキー / 説明</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><b>英数字</b></td>
                                                <td><span class="key-code">a-z, A-Z, 0-9</span></td>
                                                <td>英字(A-Z), 数字(0-9)</td>
                                            </tr>

                                            <tr>
                                                <td><b>ファンクション</b></td>
                                                <td><span class="key-code">F1 - F12</span></td>
                                                <td>F1 ～ F12 キー</td>
                                            </tr>

                                            <tr>
                                                <td rowspan="6"><b>制御・編集</b></td>
                                                <td><span class="key-code">ENTER, RETURN</span></td>
                                                <td>Enter (リターン)</td>
                                            </tr>
                                            <tr><td><span class="key-code">ESC, ESCAPE</span></td><td>Esc (エスケープ)</td></tr>
                                            <tr><td><span class="key-code">BACKSPACE, BKSP</span></td><td>Backspace</td></tr>
                                            <tr><td><span class="key-code">TAB</span></td><td>Tab</td></tr>
                                            <tr><td><span class="key-code">SPACE, SPACEBAR</span></td><td>Space (空白)</td></tr>
                                            <tr><td><span class="key-code">CAPSLOCK, CAPS</span></td><td>CapsLock</td></tr>

                                            <tr>
                                                <td rowspan="5"><b>移動・削除</b></td>
                                                <td><span class="key-code">UP, DOWN, LEFT, RIGHT</span></td>
                                                <td>矢印 (↑, ↓, ←, →)<br><span style="font-size:0.75em; color:#888">ARROWUP, ARROWDOWN...</span></td>
                                            </tr>
                                            <tr><td><span class="key-code">PGUP, PGDN</span></td><td>PageUp, PageDown<br><span style="font-size:0.75em; color:#888">PAGEUP, PAGEDOWN</span></td></tr>
                                            <tr><td><span class="key-code">HOME, END</span></td><td>Home, End</td></tr>
                                            <tr><td><span class="key-code">INSERT, INS</span></td><td>Insert</td></tr>
                                            <tr><td><span class="key-code">DELETE, DEL</span></td><td>Delete</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>システム</b></td>
                                                <td><span class="key-code">PRINTSCREEN, PRTSC</span></td>
                                                <td>PrintScreen</td>
                                            </tr>
                                            <tr><td><span class="key-code">SCROLLLOCK</span></td><td>ScrollLock</td></tr>
                                            <tr><td><span class="key-code">PAUSE, BREAK</span></td><td>Pause / Break</td></tr>
                                            <tr><td><span class="key-code">NUMLOCK</span></td><td>NumLock</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>修飾キー</b></td>
                                                <td><span class="key-code">CTRL, LCTRL, RCTRL</span></td>
                                                <td>Ctrl (左右)</td>
                                            </tr>
                                            <tr><td><span class="key-code">SHIFT, LSHIFT, RSHIFT</span></td><td>Shift (左右)</td></tr>
                                            <tr><td><span class="key-code">ALT, LALT, RALT</span></td><td>Alt (左右)</td></tr>
                                            <tr><td><span class="key-code">WIN, GUI, CMD</span></td><td>Windows / Command (左右)</td></tr>

                                            <tr>
                                                <td rowspan="4"><b>日本語キー</b></td>
                                                <td><span class="key-code">HENKAN</span></td>
                                                <td>変換</td>
                                            </tr>
                                            <tr><td><span class="key-code">MUHENKAN</span></td><td>無変換</td></tr>
                                            <tr><td><span class="key-code">ZENKAKU, HANKAKU</span></td><td>全角/半角 (ZENKAKUHANKAKU)</td></tr>
                                            <tr><td><span class="key-code">KATAKANA, HIRAGANA</span></td><td>カタカナ/ひらがな</td></tr>

                                            <tr>
                                                <td rowspan="14"><b>記号</b><br><span style="font-size:0.8em; font-weight:normal">直接入力可</span></td>
                                                <td><span class="key-code">EXCLAMATION</span></td><td><b>!</b> (感嘆符)</td>
                                            </tr>
                                            <tr><td><span class="key-code">DOUBLEQUOTE</span></td><td><b>"</b> (二重引用符)</td></tr>
                                            <tr><td><span class="key-code">HASH</span></td><td><b>#</b> (井桁)</td></tr>
                                            <tr><td><span class="key-code">DOLLAR</span></td><td><b>$</b> (ドル)</td></tr>
                                            <tr><td><span class="key-code">PERCENT</span></td><td><b>%</b> (パーセント)</td></tr>
                                            <tr><td><span class="key-code">AMPERSAND</span></td><td><b>&amp;</b> (アンパサンド)</td></tr>
                                            <tr><td><span class="key-code">APOSTROPHE</span></td><td><b>'</b> (シングルクォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTPAREN, RIGHTPAREN</span></td><td><b>( )</b> (小括弧)</td></tr>
                                            <tr><td><span class="key-code">ASTERISK, MUL</span></td><td><b>*</b> (アスタリスク)</td></tr>
                                            <tr><td><span class="key-code">PLUS, ADD</span></td><td><b>+</b> (プラス)</td></tr>
                                            <tr><td><span class="key-code">COMMA, DOT</span></td><td><b>, .</b> (カンマ, ドット)</td></tr>
                                            <tr><td><span class="key-code">MINUS</span></td><td><b>-</b> (マイナス)</td></tr>
                                            <tr><td><span class="key-code">SLASH, BACKSLASH</span></td><td><b>/ \</b> (スラッシュ, バックスラッシュ)</td></tr>
                                            <tr><td><span class="key-code">COLON, SEMICOLON</span></td><td><b>: ;</b> (コロン, セミコロン)</td></tr>
                                            <tr><td><span class="key-code">LESS, GREATER</span></td><td><b>&lt; &gt;</b> (小なり, 大なり)</td></tr>
                                            <tr><td><span class="key-code">EQUAL</span></td><td><b>=</b> (イコール)</td></tr>
                                            <tr><td><span class="key-code">QUESTION</span></td><td><b>?</b> (疑問符)</td></tr>
                                            <tr><td><span class="key-code">AT</span></td><td><b>@</b> (アットマーク)</td></tr>
                                            <tr><td><span class="key-code">LEFTBRACE, RIGHTBRACE</span></td><td><b>[ ]</b> (大括弧)</td></tr>
                                            <tr><td><span class="key-code">CARET</span></td><td><b>^</b> (キャレット)</td></tr>
                                            <tr><td><span class="key-code">UNDERSCORE</span></td><td><b>_</b> (アンダースコア)</td></tr>
                                            <tr><td><span class="key-code">GRAVE</span></td><td><b>`</b> (バッククォート)</td></tr>
                                            <tr><td><span class="key-code">LEFTCURLY, RIGHTCURLY</span></td><td><b>{ }</b> (中括弧)</td></tr>
                                            <tr><td><span class="key-code">PIPE, BAR</span></td><td><b>|</b> (縦棒)</td></tr>
                                            <tr><td><span class="key-code">TILDE</span></td><td><b>~</b> (チルダ)</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="detail-sample">
REM スペースキーを0.1秒間押して離す
KeyPushFor(SPACE, 0.1)

REM 'z' キーを0.5秒間押す
KeyPushFor(z, 0.5)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert='KeyType("Hello", 0.05, 0.05)'><span class="doc-syntax">KeyType("str", p, r)</span>
                                <div class="doc-desc">文字列をタイプします。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                指定した文字列をキーボードで順番に入力します。<br>
                                <b>動作:</b> 文字列を1文字ずつ分解し、押す・離すを繰り返します。<br>
                                <b>引数:</b>
                                <ul>
                                    <li><code>"str"</code>: 入力したい文字列（ダブルクォート必須）。\n(改行)も使えます。</li>
                                    <li><code>p</code>: キーを押している時間(秒)</li>
                                    <li><code>r</code>: キーを離してから次を押すまでの間隔(秒)</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM "Hello" と入力してEnter(改行)を押す
REM 1文字あたり0.03秒押し、0.03秒空ける
KeyType("Hello\n", 0.03, 0.03)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="MouseMove(100, 0, 0)"><span class="doc-syntax">MouseMove(x, y, rel)</span>
                                <div class="doc-desc">マウスカーソルを移動します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                マウスを移動、またはホイールを回転させます。<br>
                                <b>動作:</b> 現在位置からの相対移動として処理されます。<br>
                                <b>引数:</b>
                                <ul>
                                    <li><code>x</code>: 左右移動量 (-127 ～ 127)。正で右、負で左。</li>
                                    <li><code>y</code>: 上下移動量 (-127 ～ 127)。正で下、負で上。</li>
                                    <li><code>rel</code>: ホイール回転量。0以外を指定するとX/Y移動は無視されホイール操作になります。正で上スクロール。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM 右に50ピクセル移動
MouseMove(50, 0, 0)
REM 下に20ピクセル移動
MouseMove(0, 20, 0)
REM 斜めに移動
MouseMove(10, 10, 0)
REM ホイールを上にスクロール
MouseMove(0, 0, 1)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="MousePress(LEFT)"><span class="doc-syntax">MousePress(btn)</span>
                                <div class="doc-desc">マウスボタンを押します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                マウスボタンを押しっぱなしにします。<br>
                                <b>動作:</b> ドラッグ操作などに使用します。必ず <code>MouseRelease</code> で離してください。<br>
                                <b>引数:</b> <code>LEFT</code>(左), <code>RIGHT</code>(右), <code>MIDDLE</code>(中/ホイール)。
                            </div>
                            <div class="detail-sample">
REM 左クリック開始（ドラッグ開始）
MousePress(LEFT)
REM 押したまま移動
MouseMove(100, 50, 0)
REM 放す（ドラッグ終了）
MouseRelease(LEFT)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="MouseRelease(LEFT)"><span class="doc-syntax">MouseRelease(btn)</span>
                                <div class="doc-desc">マウスボタンを離します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                押されているマウスボタンを離します。<br>
                                <b>引数:</b> <code>LEFT</code>, <code>RIGHT</code>, <code>MIDDLE</code>。
                            </div>
                            <div class="detail-sample">
REM (MousePressのサンプルを参照)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="MousePushFor(LEFT, 0.1)"><span class="doc-syntax">MousePushFor(btn, sec)</span>
                                <div class="doc-desc">指定時間クリックします。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                マウスボタンを一回クリック（押して離す）します。<br>
                                <b>動作:</b> <code>MousePress</code> → 待機 → <code>MouseRelease</code> を自動で行います。<br>
                                <b>引数:</b> ボタン名, 押す時間(秒)。
                            </div>
                            <div class="detail-sample">
REM 左クリック (0.05秒間押す)
MousePushFor(LEFT, 0.05)
REM 右クリック
MousePushFor(RIGHT, 0.05)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert='Mouserun("file.txt", 1, 0, 1)'><span class="doc-syntax">Mouserun("file", t, a, s)</span>
                                <div class="doc-desc">操作記録を再生します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                事前にFlashに保存されたCSVファイル("x,y,wheel,L,R,M,ms")を読み込み、マウス操作を再現します。<br>
                                <b>動作:</b> 指定ファイルを1行ずつ読み込み、移動とクリックを実行します。<br>
                                <b>引数:</b>
                                <ul>
                                    <li><code>file</code>: ファイル名（ダブルクォート必須）。</li>
                                    <li><code>t</code>: 再生速度倍率（1.0が等速、0.5なら倍速）。</li>
                                    <li><code>a</code>: 回転角度（ラジアン）。3.14で180度反転。</li>
                                    <li><code>s</code>: 移動距離の拡大縮小倍率（1.0が等倍）。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM "rec.txt" を等速、回転なし、等倍で再生
Mouserun("rec.txt", 1.0, 0.0, 1.0)

REM 2倍速(待機時間半分)、180度回転(上下左右反転)させて再生
Mouserun("rec.txt", 0.5, 3.14159, 1.0)
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h2>Proコントローラー (ProControllerモード)</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="ProConPress(A)"><span class="doc-syntax">ProConPress(btn)</span>
                                <div class="doc-desc">ボタンを押します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                コントローラーのボタンを押しっぱなしにします。<br>
                                <b>動作:</b> Switch本体に「ボタンが押された」信号を送り続けます。<br>
                                <b>引数:</b> A, B, X, Y, L, R, ZL, ZR, MINUS, PLUS, LCLICK, RCLICK, HOME, CAPTURE
                            </div>
                            <div class="detail-sample">
REM Aボタンを押し続ける
ProConPress(A)
WAIT 0.1
REM 離す
ProConRelease(A)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="ProConRelease(A)"><span class="doc-syntax">ProConRelease(btn)</span>
                                <div class="doc-desc">ボタンを離します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                押されているボタンを離します。
                            </div>
                            <div class="detail-sample">
REM (ProConPressのサンプルを参照)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="ProConPushFor(A, 0.1)"><span class="doc-syntax">ProConPushFor(btn, sec)</span>
                                <div class="doc-desc">指定時間ボタンを押します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                ボタンを一回押して離します。<br>
                                <b>動作:</b> 押す→待機→離す を自動で行います。<br>
                                <b>引数:</b> ボタン名, 押す時間(秒)。
                            </div>
                            <div class="detail-sample">
REM Aボタンを0.05秒だけ短く押す
ProConPushFor(A, 0.05)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="ProConHat(UP)"><span class="doc-syntax">ProConHat(dir)</span>
                                <div class="doc-desc">十字キーを操作します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                十字キー（ハットスイッチ）の入力を設定します。<br>
                                <b>動作:</b> 指定した方向にキーが入った状態になります。解除するまで維持されます。<br>
                                <b>引数:</b> UP, DOWN, LEFT, RIGHT, UP_RIGHT, DOWN_LEFT など。<br>
                                解除するには <code>CENTER</code> を指定します。
                            </div>
                            <div class="detail-sample">
REM 上に入力
ProConHat(UP)
WAIT 0.5
REM 右下に入力
ProConHat(RIGHT_DOWN)
WAIT 0.5
REM ニュートラル(離す)
ProConHat(CENTER)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="ProConJoy(0,0,0,0)"><span class="doc-syntax">ProConJoy(lx,ly,rx,ry)</span>
                                <div class="doc-desc">スティックを操作します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                左右のアナログスティックの傾きを設定します。<br>
                                <b>動作:</b> 指定した座標にスティックが固定されます。<br>
                                <b>引数:</b> 左X, 左Y, 右X, 右Y の順。<br>
                                値の範囲は -128 ～ 127 です。0が中心、負が左/上、正が右/下です。
                            </div>
                            <div class="detail-sample">
REM 左スティックを右(127)へ、右スティックを上(-128)へ最大入力
ProConJoy(127, 0, 0, -128)
WAIT 1.0
REM すべて中心に戻す
ProConJoy(0, 0, 0, 0)
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h2>数式・組み込み関数</h2>
                    
                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="IsPressed()"><span class="doc-syntax">IsPressed()</span>
                                <div class="doc-desc">本体ボタンの状態取得。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                Pico本体のBOOTSELボタンが現在押されているかを確認します。<br>
                                <b>戻り値:</b> 押されていれば 1.0、離れていれば 0.0。<br>
                                <b>用途:</b> 外部スイッチとして使い、スクリプトの一時停止やモード切替に使えます。
                            </div>
                            <div class="detail-sample">
LABEL WaitBtn
WAIT 0.1
REM ボタンが押される(1.0になる)までループ
IF IsPressed() == 0 GOTO WaitBtn
PRINT "ボタンが押されました！"
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="Rand(0, 10)"><span class="doc-syntax">Rand(min, max)</span>
                                <div class="doc-desc">乱数を生成します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                min から max までの範囲のランダムな実数（double）を返します。<br>
                                <b>戻り値:</b> min以上 max以下のランダムな数値。
                            </div>
                            <div class="detail-sample">
REM 1から100までの乱数を生成
SET r = Rand(1, 100)
PRINT r

REM 0.5秒～1.5秒のランダム待機
WAIT Rand(0.5, 1.5)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="GetTime()"><span class="doc-syntax">GetTime()</span>
                                <div class="doc-desc">経過時間を取得します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                スクリプト開始からの経過時間をミリ秒(ms)単位で返します。<br>
                                <b>戻り値:</b> 経過ミリ秒（1秒=1000）。
                            </div>
                            <div class="detail-sample">
SET start = GetTime()
WAIT 1.0
SET now = GetTime()
SET elapsed = now - start
REM およそ1000.0に近い値が表示される
PRINT elapsed
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="round(3.14, 0)"><span class="doc-syntax">算術・丸め (abs, round, floor...)</span>
                                <div class="doc-desc">四捨五入、切り捨て、絶対値など。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                基本的な数値操作を行います。<br>
                                <ul>
                                    <li><code>abs(x)</code>: 絶対値を返します。</li>
                                    <li><code>sign(x)</code>: 符号を返します（正:1, 負:-1, 0:0）。</li>
                                    <li><code>round(x, d)</code>: xを小数点以下d桁で四捨五入します。</li>
                                    <li><code>floor(x)</code>: 切り捨て（床関数）。x以下の最大の整数。</li>
                                    <li><code>ceil(x)</code>: 切り上げ（天井関数）。x以上の最小の整数。</li>
                                    <li><code>trunc(x)</code>: 0に近い方向へ整数化（小数点以下削除）。</li>
                                    <li><code>mod(a, b)</code>: a を b で割った余り (a % b)。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
SET v = -3.7
PRINT abs(v)      REM 3.7
PRINT sign(v)     REM -1.0
PRINT round(v, 0) REM -4.0 (四捨五入)
PRINT floor(v)    REM -4.0 (より小さい整数へ)
PRINT ceil(v)     REM -3.0 (より大きい整数へ)
PRINT trunc(v)    REM -3.0 (小数カット)
PRINT mod(10, 3)  REM 1.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="sqrt(2)"><span class="doc-syntax">指数・対数 (pow, sqrt, log...)</span>
                                <div class="doc-desc">べき乗、平方根、対数など。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                <ul>
                                    <li><code>pow(b, e)</code>: bのe乗を返します。</li>
                                    <li><code>sqr(x)</code>: xの2乗を返します (x * x)。</li>
                                    <li><code>sqrt(x)</code>: xの平方根（ルート）を返します。</li>
                                    <li><code>exp(x)</code>: 指数関数 e^x を返します。</li>
                                    <li><code>ln(x)</code>: xの自然対数（底がe）を返します。</li>
                                    <li><code>log10(x)</code>: xの常用対数（底が10）を返します。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
PRINT pow(2, 3)   REM 8.0
PRINT sqr(3)      REM 9.0
PRINT sqrt(2)     REM 1.4142...
PRINT exp(1)      REM 2.7182... (e)
PRINT ln(2.71828) REM 1.0
PRINT log10(100)  REM 2.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="sin(0)"><span class="doc-syntax">三角関数 (sin, cos, tan, cot)</span>
                                <div class="doc-desc">基本的な三角関数。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                角度の単位はすべて<b>ラジアン</b>です。度数法を使う場合は<code>deg2rad</code>と組み合わせてください。<br>
                                <ul>
                                    <li><code>sin(r)</code>: 正弦（サイン）。</li>
                                    <li><code>cos(r)</code>: 余弦（コサイン）。</li>
                                    <li><code>tan(r)</code>: 正接（タンジェント）。</li>
                                    <li><code>cot(r)</code>: 余接（コタンジェント, 1/tan）。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
SET pi = 3.1415926
PRINT sin(pi / 2) REM 1.0
PRINT cos(pi)     REM -1.0
PRINT tan(pi / 4) REM 1.0
PRINT cot(pi / 4) REM 1.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="atan2(1, 1)"><span class="doc-syntax">逆三角関数 (asin, acos, atan...)</span>
                                <div class="doc-desc">角度を求める関数。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                値から角度（ラジアン）を求めます。<br>
                                <ul>
                                    <li><code>asin(x)</code>: アークサイン。-1～1の値を受け取り、-π/2～π/2を返します。</li>
                                    <li><code>acos(x)</code>: アークコサイン。-1～1の値を受け取り、0～πを返します。</li>
                                    <li><code>atan(x)</code>: アークタンジェント。-π/2～π/2を返します。</li>
                                    <li><code>atan2(y, x)</code>: 座標(x, y)の角度を -π～π で返します。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM sinが1になる角度は PI/2 (1.5707...)
PRINT asin(1)

REM cosが-1になる角度は PI (3.1415...)
PRINT acos(-1)

REM tanが1になる角度は PI/4 (0.7853...)
PRINT atan(1)

REM 座標(1, 1)の角度は45度(PI/4)
PRINT atan2(1, 1)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="tanh(1)"><span class="doc-syntax">双曲線関数 (sinh, cosh, tanh)</span>
                                <div class="doc-desc">ハイパボリック関数。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                双曲線関数です。<br>
                                <ul>
                                    <li><code>sinh(x)</code>: 双曲線正弦。</li>
                                    <li><code>cosh(x)</code>: 双曲線余弦。</li>
                                    <li><code>tanh(x)</code>: 双曲線正接。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
PRINT sinh(0)  REM 0.0
PRINT cosh(0)  REM 1.0
PRINT tanh(0)  REM 0.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="deg2rad(90)"><span class="doc-syntax">角度変換 (deg2rad, rad2deg)</span>
                                <div class="doc-desc">度数法と弧度法の変換。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                <ul>
                                    <li><code>deg2rad(d)</code>: 度数(deg)をラジアン(rad)に変換します。<br>(例: 180 -> 3.14...)</li>
                                    <li><code>rad2deg(r)</code>: ラジアン(rad)を度数(deg)に変換します。<br>(例: 3.14... -> 180)</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM 30度のサインを計算
SET deg = 30
SET rad = deg2rad(deg)
PRINT sin(rad)    REM 0.5

REM ラジアンを度数に戻す
PRINT rad2deg(rad) REM 30.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="max(1, 2)"><span class="doc-syntax">集計・比較 (min, max, clamp...)</span>
                                <div class="doc-desc">最大・最小・範囲制限など。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                <ul>
                                    <li><code>min(a, b, ...)</code>: 引数の中で最小の値を返します（引数は多数可）。</li>
                                    <li><code>max(a, b, ...)</code>: 引数の中で最大の値を返します。</li>
                                    <li><code>clamp(x, low, high)</code>: x を low～high の範囲に収めます。</li>
                                    <li><code>sum(a, b, ...)</code>: 引数の合計値を返します。</li>
                                    <li><code>average(a, b, ...)</code>: 引数の平均値を返します。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
PRINT min(10, 5, 8)      REM 5.0
PRINT max(10, 5, 8)      REM 10.0
REM 150を0-100の範囲に収める -> 100
PRINT clamp(150, 0, 100) 
PRINT sum(1, 2, 3)       REM 6.0
PRINT average(10, 20)    REM 15.0
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="fact(5)"><span class="doc-syntax">順列・組合せ (fact, ncr, npr)</span>
                                <div class="doc-desc">階乗や組み合わせの計算。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                <ul>
                                    <li><code>fact(n)</code>: nの階乗 (n!) を返します。</li>
                                    <li><code>ncr(n, r)</code>: n個からr個を選ぶ組み合わせの数 (${}_nC_r$)。</li>
                                    <li><code>npr(n, r)</code>: n個からr個を選んで並べる順列の数 (${}_nP_r$)。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
PRINT fact(5)    REM 120.0 (5*4*3*2*1)
PRINT ncr(5, 2)  REM 10.0  (5C2)
PRINT npr(5, 2)  REM 20.0  (5P2)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="if(1, 10, 20)"><span class="doc-syntax">条件分岐 (if, ifs)</span>
                                <div class="doc-desc">条件に応じた値を返します。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                0.0は「偽」、それ以外は「真」として扱われます。<br>
                                <ul>
                                    <li><code>if(cond, true_val, false_val)</code>: condが真ならtrue_val、偽ならfalse_valを返します。</li>
                                    <li><code>ifs(c1, v1, c2, v2, ...)</code>: 条件を順に評価し、最初に真になった条件の値を返します。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
SET score = 85
REM 80点以上なら "Pass"(=1)、不合格なら "Fail"(=0)
SET result = if(score >= 80, 1, 0)
PRINT result

REM 複数条件の判定
REM 90以上->3, 70以上->2, その他->1
SET rank = ifs(score>=90, 3, score>=70, 2, 1, 1)
PRINT rank
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="and(1, 0)"><span class="doc-syntax">論理演算 (and, or, not)</span>
                                <div class="doc-desc">論理積、論理和、否定。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                数値を論理値(真/偽)として扱います。0は偽、0以外は真です。<br>
                                <ul>
                                    <li><code>and(a, b)</code>: 両方真なら1、そうでなければ0。</li>
                                    <li><code>or(a, b)</code>: どちらかが真なら1、そうでなければ0。</li>
                                    <li><code>not(x)</code>: xが0なら1、0以外なら0。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
SET a = 1
SET b = 0
PRINT and(a, b)  REM 0.0 (False)
PRINT or(a, b)   REM 1.0 (True)
PRINT not(a)     REM 0.0 (False)
PRINT not(b)     REM 1.0 (True)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="iseven(2)"><span class="doc-syntax">判定・検査 (iseven, isnan...)</span>
                                <div class="doc-desc">偶数奇数やエラーの判定。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                数値の状態を判定します。結果は1(真)または0(偽)です。<br>
                                <ul>
                                    <li><code>iseven(x)</code>: 偶数なら1。</li>
                                    <li><code>isodd(x)</code>: 奇数なら1。</li>
                                    <li><code>isnan(x)</code>: 非数(NaN)なら1。</li>
                                    <li><code>iserr(x)</code>: エラー値なら1。</li>
                                    <li><code>even(x)</code>: xを最も近い偶数に丸めます。</li>
                                    <li><code>odd(x)</code>: xを最も近い奇数に丸めます。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
PRINT iseven(4)  REM 1.0
PRINT isodd(4)   REM 0.0
PRINT even(3.5)  REM 4.0 (偶数化)
PRINT odd(4)     REM 5.0 (奇数化)
                            </div>
                        </div>
                    </div>

                    <div class="doc-entry">
                        <div class="doc-header">
                            <div class="doc-item" data-insert="pi()"><span class="doc-syntax">定数 (pi, e, true, false)</span>
                                <div class="doc-desc">数学定数と論理定数。</div>
                            </div>
                            <button class="doc-toggle">▼</button>
                        </div>
                        <div class="doc-detail">
                            <div class="detail-desc">
                                <ul>
                                    <li><code>pi()</code>: 円周率 (約 3.14159)。</li>
                                    <li><code>e()</code>: ネイピア数 (約 2.71828)。</li>
                                    <li><code>true()</code>: 真 (1.0)。</li>
                                    <li><code>false()</code>: 偽 (0.0)。</li>
                                </ul>
                            </div>
                            <div class="detail-sample">
REM 半径10の円の面積 (pi * r^2)
SET r = 10
SET area = pi() * sqr(r)
PRINT area

REM 無限ループ用
IF true() GOTO Next
LABEL Next
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div id="structure" class="tab-content">
                <div class="struct-item" style="cursor:default; background:#eee;"><b>ラベル一覧</b></div>
                <div id="label-list"></div>
                <div class="struct-item" style="cursor:default; background:#eee; margin-top:20px;"><b>変数一覧</b></div>
                <div id="var-list"></div>
            </div>

            <div id="flowchart" class="tab-content">
                <div id="mermaid-container">Loading...</div>
                <button class="tool-btn" id="btn-update-flowchart" style="margin-top:10px;">更新</button>
            </div>
        </div>
    </div>
    <div id="disclaimer-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="modal-title">【重要】免責事項 (Disclaimer)</h2>
            <div class="modal-body">
                <p>本デバイスおよび本ソフトウェア（以下「本製品」）の利用は、すべて<strong>利用者の自己責任</strong>において行われるものとします。</p>
                <p>開発者および販売者は、本製品の使用に関連して利用者が被ったいかなる損害（セキュリティ事故、アカウント停止/BAN、ハードウェアの故障、利益の損失等）について、一切の責任を負いません。</p>
                <div class="modal-alert">
                    <ul>
                        <li><strong>パスワード管理:</strong> 自動入力機能を使用する場合、情報はデバイス内に保存されます。紛失・盗難には十分ご注意ください。</li>
                        <li><strong>規約違反リスク:</strong> オンラインゲーム等での自動化ツールの使用は、サービスの利用規約に違反する可能性があります。</li>
                    </ul>
                </div>
                <p>上記を理解し、同意した上で使用してください。</p>
            </div>
            <div class="modal-footer">
                <label class="modal-checkbox">
                    <input type="checkbox" id="dont-show-again"> 次回から表示しない
                </label>
                <button id="agree-btn" class="modal-btn">同意して使用する</button>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>

</html>